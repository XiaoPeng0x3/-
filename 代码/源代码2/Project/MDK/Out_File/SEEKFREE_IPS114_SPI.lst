C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE SEEKFREE_IPS114_SPI
OBJECT MODULE PLACED IN .\Out_File\SEEKFREE_IPS114_SPI.obj
COMPILER INVOKED BY: D:\Keil_v5\C251\BIN\C251.EXE ..\..\Libraries\seekfree_peripheral\SEEKFREE_IPS114_SPI.c XSMALL INTR2
                    - WARNINGLEVEL(0) BROWSE INCDIR(..\..\Libraries\libraries;..\..\Libraries\seekfree_libraries;..\..\Libraries\seekfree_per
                    -ipheral;..\CODE;..\USER\inc;..\USER\src) DEBUG PRINT(.\Out_File\SEEKFREE_IPS114_SPI.lst) TABS(2) OBJECT(.\Out_File\SEEKF
                    -REE_IPS114_SPI.obj) 

stmt  level    source

    1          
    2          /********************************************************************************************************
             -*************
    3           * COPYRIGHT NOTICE
    4           * Copyright (c) 2018,é€é£ç§‘æŠ€
    5           * All rights reserved.
    6           * æŠ€æœ¯è®¨è®ºQQç¾¤ï¼šä¸€ç¾¤ï¼š179029047(å·²æ»¡)  äºŒç¾¤ï¼š244861897(å·²æ»¡)  ä¸‰ç¾¤ï¼š824575535
    7           *
    8           * ä»¥ä¸‹æ‰€æœ‰å†…å®¹ç‰ˆæƒå‡å±é€é£ç§‘æŠ€æ‰€æœ‰ï¼Œæœªç»å…è®¸ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”ï¼Œ
    9           * æ¬¢è¿å„ä½ä½¿ç”¨å¹¶ä¼ æ’­æœ¬ç¨‹åºï¼Œä¿®æ”¹å†…å®¹æ—¶å¿…é¡»ä¿ç•™é€é£ç§‘æŠ€çš„ç‰ˆæƒå£°æ˜ã€‚
   10           *
   11           * @file          main
   12           * @company       æˆéƒ½é€é£ç§‘æŠ€æœ‰é™å…¬å¸
   13           * @author        é€é£ç§‘æŠ€(QQ3184284598)
   14           * @version       æŸ¥çœ‹docå†…versionæ–‡ä»¶ ç‰ˆæœ¬è¯´æ˜
   15           * @Software    MDK FOR C251 V5.60
   16           * @Taobao      https://seekfree.taobao.com/
   17           * @date          2019-11-15
   18           * @note
   19                    æ¥çº¿å®šä¹‰ï¼š
   20                    ------------------------------------
   21                    1.14å¯¸IPSæ¨¡å—ç®¡è„š       å•ç‰‡æœºç®¡è„š
   22                    SCL                   æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_SCL   å®å®šä¹‰     ç¡¬ä»¶SPIå¼•è„
             -šä¸å¯éšæ„åˆ‡æ¢
   23                    SDA                   æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_SDA   å®å®šä¹‰     ç¡¬ä»¶SPIå¼•è„
             -šä¸å¯éšæ„åˆ‡æ¢
   24                    RES                   æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_REST_PINå®å®šä¹‰
   25                    DC                    æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_DC_PIN  å®å®šä¹‰
   26                    CS                    æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_CS    å®å®šä¹‰     ç¡¬ä»¶SPIå¼•è„š
             -ä¸å¯éšæ„åˆ‡æ¢
   27                    BL            æŸ¥çœ‹SEEKFREE_IPS114_SPI.hæ–‡ä»¶å†…çš„IPS114_BL_PIN  å®å®šä¹‰
   28          
   29                    ç”µæºå¼•è„š
   30                    VCC 3.3Vç”µæº
   31                    GND ç”µæºåœ°
   32                    æœ€å¤§åˆ†è¾¨ç‡135*240
   33                    ------------------------------------
   34           ********************************************************************************************************
             -************/
   35          
   36          #include "SEEKFREE_IPS114_SPI.h"
   37          #include "SEEKFREE_FONT.h"
   38          #include "SEEKFREE_PRINTF.h"
   39          #include "zf_spi.h"
   40          #include "zf_delay.h"
   41          
   42          //-------------------------------------------------------------------------------------------------------
             -------------
   43          //  ä»¥ä¸‹å‡½æ•°æ˜¯ä½¿ç”¨è½¯ä»¶SPIé€šä¿¡ï¼Œç›¸æ¯”è¾ƒç¡¬ä»¶SPIï¼Œè½¯ä»¶SPIå¼•è„šæ›´åŠ çµæ´»ï¼Œå¯ä»¥ä½¿ç”
             -¨ä»»æ„æ™®é€šIO
   44          //-------------------------------------------------------------------------------------------------------
             -------------
   45          
   46          //-------------------------------------------------------------------------------------------------------
             -------------
   47          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 2   

   48          //  @param      void
   49          //  @return
   50          //  @since      v1.0
   51          //  Sample usage:
   52          //-------------------------------------------------------------------------------------------------------
             -------------
   53          void ips114_writeIndex_simspi(uint8 dat) //å†™å‘½ä»¤
   54          {
   55   1        uint8 i = 8;
   56   1        IPS114_CS_SIMSPI(0);
   57   1        IPS114_DC_SIMSPI(0);
   58   1      
   59   1        IPS114_SCL_SIMSPI(0);
   60   1      
   61   1        while (i--)
   62   1        {
   63   2          if (dat & 0x80)
   64   2          {
   65   3            IPS114_SDA_SIMSPI(1);
   66   3          }
   67   2          else
   68   2          {
   69   3            IPS114_SDA_SIMSPI(0);
   70   3          }
   71   2          IPS114_SCL_SIMSPI(1);
   72   2      
   73   2          IPS114_SCL_SIMSPI(0);
   74   2          dat <<= 1;
   75   2        }
   76   1        IPS114_CS_SIMSPI(1);
   77   1      }
   78          
   79          //-------------------------------------------------------------------------------------------------------
             -------------
   80          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
   81          //  @param      void
   82          //  @return
   83          //  @since      v1.0
   84          //  Sample usage:
   85          //-------------------------------------------------------------------------------------------------------
             -------------
   86          void ips114_writeData_simspi(uint8 dat) //å†™æ•°æ®
   87          {
   88   1        uint8 i = 8;
   89   1        IPS114_CS_SIMSPI(0);
   90   1        IPS114_DC_SIMSPI(1);
   91   1      
   92   1        IPS114_SCL_SIMSPI(0);
   93   1      
   94   1        while (i--)
   95   1        {
   96   2          if (dat & 0x80)
   97   2          {
   98   3            IPS114_SDA_SIMSPI(1);
   99   3          }
  100   2          else
  101   2          {
  102   3            IPS114_SDA_SIMSPI(0);
  103   3          }
  104   2          IPS114_SCL_SIMSPI(1);
  105   2      
  106   2          IPS114_SCL_SIMSPI(0);
  107   2          dat <<= 1;
  108   2        }
  109   1        IPS114_CS_SIMSPI(1);
  110   1      }
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 3   

  111          
  112          //-------------------------------------------------------------------------------------------------------
             -------------
  113          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
  114          //  @param      void
  115          //  @return
  116          //  @since      v1.0
  117          //  Sample usage:
  118          //-------------------------------------------------------------------------------------------------------
             -------------
  119          void ips114_writeDatai_16bit_simspi(uint16 dat) //å‘æ¶²æ™¶å±å†™ä¸€ä¸ª16ä½æ•°æ®
  120          {
  121   1        uint8 i = 16;
  122   1        IPS114_CS_SIMSPI(0);
  123   1        IPS114_DC_SIMSPI(1);
  124   1        IPS114_SCL_SIMSPI(0);
  125   1        while (i--)
  126   1        {
  127   2          if (dat & 0x8000)
  128   2          {
  129   3            IPS114_SDA_SIMSPI(1);
  130   3          }
  131   2          else
  132   2          {
  133   3            IPS114_SDA_SIMSPI(0);
  134   3          }
  135   2          IPS114_SCL_SIMSPI(1);
  136   2      
  137   2          IPS114_SCL_SIMSPI(0);
  138   2          dat <<= 1;
  139   2        }
  140   1        IPS114_CS_SIMSPI(1);
  141   1      }
  142          
  143          //-------------------------------------------------------------------------------------------------------
             -------------
  144          //  @brief      1.14å¯¸ IPSæ¶²æ™¶åˆå§‹åŒ–
  145          //  @return     void
  146          //  @since      v1.0
  147          //  Sample usage:
  148          //-------------------------------------------------------------------------------------------------------
             -------------
  149          void ips114_init_simspi(void)
  150          {
  151   1      
  152   1        IPS114_BL_SIMSPI(1);
  153   1        IPS114_DC_SIMSPI(0);
  154   1        IPS114_REST_SIMSPI(0);
  155   1      
  156   1        delay_ms(200);
  157   1      
  158   1        IPS114_REST_SIMSPI(1);
  159   1        delay_ms(100);
  160   1      
  161   1        ips114_writeIndex_simspi(0x36);
  162   1      
  163   1      #if (IPS114_DISPLAY_DIR == 0)
                 ips114_writeData_simspi(0x00);
               #elif (IPS114_DISPLAY_DIR == 1)
                 ips114_writeData_simspi(0xC0);
               #elif (IPS114_DISPLAY_DIR == 2)
                 ips114_writeData_simspi(0x70);
               #else
  170   1        ips114_writeData_simspi(0xA0);
  171   1      #endif
  172   1        ips114_writeIndex_simspi(0x3A);
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 4   

  173   1        ips114_writeData_simspi(0x05);
  174   1      
  175   1        ips114_writeIndex_simspi(0xB2);
  176   1        ips114_writeData_simspi(0x0C);
  177   1        ips114_writeData_simspi(0x0C);
  178   1        ips114_writeData_simspi(0x00);
  179   1        ips114_writeData_simspi(0x33);
  180   1        ips114_writeData_simspi(0x33);
  181   1      
  182   1        ips114_writeIndex_simspi(0xB7);
  183   1        ips114_writeData_simspi(0x35);
  184   1      
  185   1        ips114_writeIndex_simspi(0xBB);
  186   1        ips114_writeData_simspi(0x37);
  187   1      
  188   1        ips114_writeIndex_simspi(0xC0);
  189   1        ips114_writeData_simspi(0x2C);
  190   1      
  191   1        ips114_writeIndex_simspi(0xC2);
  192   1        ips114_writeData_simspi(0x01);
  193   1      
  194   1        ips114_writeIndex_simspi(0xC3);
  195   1        ips114_writeData_simspi(0x12);
  196   1      
  197   1        ips114_writeIndex_simspi(0xC4);
  198   1        ips114_writeData_simspi(0x20);
  199   1      
  200   1        ips114_writeIndex_simspi(0xC6);
  201   1        ips114_writeData_simspi(0x0F);
  202   1      
  203   1        ips114_writeIndex_simspi(0xD0);
  204   1        ips114_writeData_simspi(0xA4);
  205   1        ips114_writeData_simspi(0xA1);
  206   1      
  207   1        ips114_writeIndex_simspi(0xE0);
  208   1        ips114_writeData_simspi(0xD0);
  209   1        ips114_writeData_simspi(0x04);
  210   1        ips114_writeData_simspi(0x0D);
  211   1        ips114_writeData_simspi(0x11);
  212   1        ips114_writeData_simspi(0x13);
  213   1        ips114_writeData_simspi(0x2B);
  214   1        ips114_writeData_simspi(0x3F);
  215   1        ips114_writeData_simspi(0x54);
  216   1        ips114_writeData_simspi(0x4C);
  217   1        ips114_writeData_simspi(0x18);
  218   1        ips114_writeData_simspi(0x0D);
  219   1        ips114_writeData_simspi(0x0B);
  220   1        ips114_writeData_simspi(0x1F);
  221   1        ips114_writeData_simspi(0x23);
  222   1      
  223   1        ips114_writeIndex_simspi(0xE1);
  224   1        ips114_writeData_simspi(0xD0);
  225   1        ips114_writeData_simspi(0x04);
  226   1        ips114_writeData_simspi(0x0C);
  227   1        ips114_writeData_simspi(0x11);
  228   1        ips114_writeData_simspi(0x13);
  229   1        ips114_writeData_simspi(0x2C);
  230   1        ips114_writeData_simspi(0x3F);
  231   1        ips114_writeData_simspi(0x44);
  232   1        ips114_writeData_simspi(0x51);
  233   1        ips114_writeData_simspi(0x2F);
  234   1        ips114_writeData_simspi(0x1F);
  235   1        ips114_writeData_simspi(0x1F);
  236   1        ips114_writeData_simspi(0x20);
  237   1        ips114_writeData_simspi(0x23);
  238   1      
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 5   

  239   1        ips114_writeIndex_simspi(0x21);
  240   1      
  241   1        ips114_writeIndex_simspi(0x11);
  242   1        delay_ms(120);
  243   1      
  244   1        ips114_writeIndex_simspi(0x29);
  245   1        ips114_clear_simspi(IPS114_BGCOLOR);
  246   1      }
  247          
  248          void ips114_set_region_simspi(uint16 x1, uint16 y1, uint16 x2, uint16 y2)
  249          {
  250   1      #if (IPS114_DISPLAY_DIR == 0)
                 {
                   ips114_writeIndex_simspi(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(x1 + 52);
                   ips114_writeDatai_16bit_simspi(x2 + 52);
                   ips114_writeIndex_simspi(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(y1 + 40);
                   ips114_writeDatai_16bit_simspi(y2 + 40);
                   ips114_writeIndex_simspi(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #elif (IPS114_DISPLAY_DIR == 1)
                 {
                   ips114_writeIndex_simspi(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(x1 + 53);
                   ips114_writeDatai_16bit_simspi(x2 + 53);
                   ips114_writeIndex_simspi(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(y1 + 40);
                   ips114_writeDatai_16bit_simspi(y2 + 40);
                   ips114_writeIndex_simspi(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #elif (IPS114_DISPLAY_DIR == 2)
                 {
                   ips114_writeIndex_simspi(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(x1 + 40);
                   ips114_writeDatai_16bit_simspi(x2 + 40);
                   ips114_writeIndex_simspi(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writeDatai_16bit_simspi(y1 + 53);
                   ips114_writeDatai_16bit_simspi(y2 + 53);
                   ips114_writeIndex_simspi(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #else
  281   1        {
  282   2          ips114_writeIndex_simspi(0x2a); //åˆ—åœ°å€è®¾ç½®
  283   2          ips114_writeDatai_16bit_simspi(x1 + 40);
  284   2          ips114_writeDatai_16bit_simspi(x2 + 40);
  285   2          ips114_writeIndex_simspi(0x2b); //è¡Œåœ°å€è®¾ç½®
  286   2          ips114_writeDatai_16bit_simspi(y1 + 52);
  287   2          ips114_writeDatai_16bit_simspi(y2 + 52);
  288   2          ips114_writeIndex_simspi(0x2c); //å‚¨å­˜å™¨å†™
  289   2        }
  290   1      #endif
  291   1      }
  292          
  293          //-------------------------------------------------------------------------------------------------------
             -------------
  294          //  @brief      æ¶²æ™¶æ¸…å±å‡½æ•°
  295          //  @param      color         é¢œè‰²è®¾ç½®
  296          //  @return     void
  297          //  @since      v1.0
  298          //  Sample usage:               ips114_clear(YELLOW);// å…¨å±è®¾ç½®ä¸ºé»„è‰²
  299          //-------------------------------------------------------------------------------------------------------
             -------------
  300          void ips114_clear_simspi(uint16 color)
  301          {
  302   1        uint16 i, j;
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 6   

  303   1        ips114_set_region_simspi(0, 0, IPS114_X_MAX - 1, IPS114_Y_MAX - 1);
  304   1        for (i = 0; i < IPS114_X_MAX; i++)
  305   1        {
  306   2          for (j = 0; j < IPS114_Y_MAX; j++)
  307   2          {
  308   3            ips114_writeDatai_16bit_simspi(color);
  309   3          }
  310   2        }
  311   1      }
  312          
  313          //-------------------------------------------------------------------------------------------------------
             -------------
  314          //  @brief      æ¶²æ™¶ç”»ç‚¹
  315          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹
  316          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹
  317          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„é¢œè‰²
  318          //  @return     void
  319          //  @since      v1.0
  320          //  Sample usage:               ips114_drawpoint(0,0,RED);  //åæ ‡0,0ç”»ä¸€ä¸ªçº¢è‰²çš„ç‚¹
  321          //-------------------------------------------------------------------------------------------------------
             -------------
  322          void ips114_drawpoint_simspi(uint16 x, uint16 y, uint16 color)
  323          {
  324   1        ips114_set_region_simspi(x, y, x, y);
  325   1        ips114_writeDatai_16bit_simspi(color);
  326   1      }
  327          
  328          //-------------------------------------------------------------------------------------------------------
             -------------
  329          //  @brief      æ¶²æ™¶æ˜¾ç¤ºå­—ç¬¦
  330          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  331          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  332          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦
  333          //  @return     void
  334          //  @since      v1.0
  335          //  Sample usage:               ips114_showchar(0,0,'x');//åæ ‡0,0å†™ä¸€ä¸ªå­—ç¬¦x
  336          //-------------------------------------------------------------------------------------------------------
             -------------
  337          void ips114_showchar_simspi(uint16 x, uint16 y, const int8 dat)
  338          {
  339   1        uint8 i, j;
  340   1        uint8 temp;
  341   1      
  342   1        for (i = 0; i < 16; i++)
  343   1        {
  344   2          ips114_set_region_simspi(x, y + i, x + 7, y + i);
  345   2          temp = tft_ascii[dat - 32][i]; //å‡32å› ä¸ºæ˜¯å–æ¨¡æ˜¯ä»ç©ºæ ¼å¼€å§‹å–å¾— ç©ºæ ¼åœ¨asciiä¸­åºå·æ˜
             -¯32
  346   2          for (j = 0; j < 8; j++)
  347   2          {
  348   3            if (temp & 0x01)
  349   3            {
  350   4              ips114_writeDatai_16bit_simspi(IPS114_PENCOLOR);
  351   4            }
  352   3            else
  353   3              ips114_writeDatai_16bit_simspi(IPS114_BGCOLOR);
  354   3            temp >>= 1;
  355   3          }
  356   2        }
  357   1      }
  358          
  359          //-------------------------------------------------------------------------------------------------------
             -------------
  360          //  @brief      æ¶²æ™¶æ˜¾ç¤ºå­—ç¬¦ä¸²
  361          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  362          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 7   

  363          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²
  364          //  @return     void
  365          //  @since      v1.0
  366          //  Sample usage:               ips114_showstr(0,0,"seekfree");
  367          //-------------------------------------------------------------------------------------------------------
             -------------
  368          void ips114_showstr_simspi(uint16 x, uint16 y, const int8 dat[])
  369          {
  370   1        uint16 j;
  371   1      
  372   1        j = 0;
  373   1        while (dat[j] != '\0')
  374   1        {
  375   2          ips114_showchar_simspi(x + 8 * j, y * 16, dat[j]);
  376   2          j++;
  377   2        }
  378   1      }
  379          
  380          //-------------------------------------------------------------------------------------------------------
             -------------
  381          //  @brief      æ¶²æ™¶æ˜¾ç¤º8ä½æœ‰ç¬¦å·
  382          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  383          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  384          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹int8
  385          //  @return     void
  386          //  @since      v1.0
  387          //  Sample usage:               ips114_showint8(0,0,x);//xä¸ºint8ç±»å‹
  388          //-------------------------------------------------------------------------------------------------------
             -------------
  389          void ips114_showint8_simspi(uint16 x, uint16 y, int8 dat)
  390          {
  391   1        uint8 a[3];
  392   1        uint8 i;
  393   1        if (dat < 0)
  394   1        {
  395   2          ips114_showchar_simspi(x, y * 16, '-');
  396   2          dat = -dat;
  397   2        }
  398   1        else
  399   1          ips114_showchar_simspi(x, y * 16, ' ');
  400   1      
  401   1        a[0] = dat / 100;
  402   1        a[1] = dat / 10 % 10;
  403   1        a[2] = dat % 10;
  404   1        i = 0;
  405   1        while (i < 3)
  406   1        {
  407   2          ips114_showchar_simspi((uint8)(x + (8 * (i + 1))), (uint8)(y * 16), (int8)('0' + a[i]));
  408   2          i++;
  409   2        }
  410   1      }
  411          
  412          //-------------------------------------------------------------------------------------------------------
             -------------
  413          //  @brief      æ¶²æ™¶æ˜¾ç¤º8ä½æ— ç¬¦å·
  414          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  415          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  416          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint8
  417          //  @return     void
  418          //  @since      v1.0
  419          //  Sample usage:               ips114_showuint8(0,0,x);//xä¸ºuint8ç±»å‹
  420          //-------------------------------------------------------------------------------------------------------
             -------------
  421          void ips114_showuint8_simspi(uint16 x, uint16 y, uint8 dat)
  422          {
  423   1        uint8 a[3];
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 8   

  424   1        uint8 i;
  425   1      
  426   1        a[0] = dat / 100;
  427   1        a[1] = dat / 10 % 10;
  428   1        a[2] = dat % 10;
  429   1        i = 0;
  430   1        while (i < 3)
  431   1        {
  432   2          ips114_showchar_simspi((uint8)(x + (8 * (i + 1))), (uint8)(y * 16), (int8)('0' + a[i]));
  433   2          i++;
  434   2        }
  435   1      }
  436          
  437          //-------------------------------------------------------------------------------------------------------
             -------------
  438          //  @brief      æ¶²æ™¶æ˜¾ç¤º16ä½æœ‰ç¬¦å·
  439          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  440          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  441          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹int16
  442          //  @return     void
  443          //  @since      v1.0
  444          //  Sample usage:               ips114_showint16(0,0,x);//xä¸ºint16ç±»å‹
  445          //-------------------------------------------------------------------------------------------------------
             -------------
  446          void ips114_showint16_simspi(uint16 x, uint16 y, int16 dat)
  447          {
  448   1        uint8 a[5];
  449   1        uint8 i;
  450   1        if (dat < 0)
  451   1        {
  452   2          ips114_showchar_simspi(x, y * 16, '-');
  453   2          dat = -dat;
  454   2        }
  455   1        else
  456   1          ips114_showchar_simspi(x, y * 16, ' ');
  457   1      
  458   1        a[0] = dat / 10000;
  459   1        a[1] = dat / 1000 % 10;
  460   1        a[2] = dat / 100 % 10;
  461   1        a[3] = dat / 10 % 10;
  462   1        a[4] = dat % 10;
  463   1      
  464   1        i = 0;
  465   1        while (i < 5)
  466   1        {
  467   2          ips114_showchar_simspi((uint8)(x + (8 * (i + 1))), (uint8)(y * 16), (int8)('0' + a[i]));
  468   2          i++;
  469   2        }
  470   1      }
  471          
  472          //-------------------------------------------------------------------------------------------------------
             -------------
  473          //  @brief      æ¶²æ™¶æ˜¾ç¤º16ä½æ— ç¬¦å·
  474          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  475          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  476          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint16
  477          //  @return     void
  478          //  @since      v1.0
  479          //  Sample usage:               ips114_showuint16(0,0,x);//xä¸ºuint16ç±»å‹
  480          //-------------------------------------------------------------------------------------------------------
             -------------
  481          void ips114_showuint16_simspi(uint16 x, uint16 y, uint16 dat)
  482          {
  483   1        uint8 a[5];
  484   1        uint8 i;
  485   1      
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 9   

  486   1        a[0] = dat / 10000;
  487   1        a[1] = dat / 1000 % 10;
  488   1        a[2] = dat / 100 % 10;
  489   1        a[3] = dat / 10 % 10;
  490   1        a[4] = dat % 10;
  491   1      
  492   1        i = 0;
  493   1        while (i < 5)
  494   1        {
  495   2          ips114_showchar_simspi((uint8)(x + (8 * (i + 1))), (uint8)(y * 16), (int8)('0' + a[i]));
  496   2          i++;
  497   2        }
  498   1      }
  499          
  500          //-------------------------------------------------------------------------------------------------------
             -------------
  501          //  @brief      æ¶²æ™¶æ˜¾ç¤º32ä½æœ‰ç¬¦å·(å»é™¤æ•´æ•°éƒ¨åˆ†æ— æ•ˆçš„0)
  502          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  503          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  504          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint32
  505          //  @param      num             éœ€è¦æ˜¾ç¤ºçš„ä½æ•° æœ€é«˜10ä½  ä¸åŒ…å«æ­£è´Ÿå·
  506          //  @return     void
  507          //  @since      v1.0
  508          //  Sample usage:               ips114_showuint32(0,0,x,3);//xå¯ä»¥ä¸ºint32 uint16 int16 uint8 int8ç±»å
             -‹
  509          //  Sample usage:               è´Ÿæ•°ä¼šæ˜¾ç¤ºä¸€ä¸ª â€˜-â€™å·   æ­£æ•°æ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼
  510          //-------------------------------------------------------------------------------------------------------
             -------------
  511          void ips114_showint32_simspi(uint16 x, uint16 y, int32 dat, uint8 num)
  512          {
  513   1        int8 buff[34];
  514   1        uint8 length;
  515   1      
  516   1        if (10 < num)
  517   1          num = 10;
  518   1      
  519   1        num++;
  520   1        if (0 > dat)
  521   1          length = zf_sprintf(&buff[0], "%d", dat); //è´Ÿæ•°
  522   1        else
  523   1        {
  524   2          buff[0] = ' ';
  525   2          length = zf_sprintf(&buff[1], "%d", dat);
  526   2          length++;
  527   2        }
  528   1        while (length < num)
  529   1        {
  530   2          buff[length] = ' ';
  531   2          length++;
  532   2        }
  533   1        buff[num] = '\0';
  534   1      
  535   1        ips114_showstr_simspi(x, y, buff); //æ˜¾ç¤ºæ•°å­—
  536   1      }
  537          
  538          //-------------------------------------------------------------------------------------------------------
             -------------
  539          //  @brief      æ¶²æ™¶æ˜¾ç¤ºæµ®ç‚¹æ•°(å»é™¤æ•´æ•°éƒ¨åˆ†æ— æ•ˆçš„0)
  540          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  541          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  542          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹floatæˆ–double
  543          //  @param      num             æ•´æ•°ä½æ˜¾ç¤ºé•¿åº¦   æœ€é«˜10ä½
  544          //  @param      pointnum        å°æ•°ä½æ˜¾ç¤ºé•¿åº¦   æœ€é«˜6ä½
  545          //  @return     void
  546          //  @since      v1.0
  547          //  Sample usage:               ips114_showfloat(0,0,x,2,3);//æ˜¾ç¤ºæµ®ç‚¹æ•°   æ•´æ•°æ˜¾ç¤º2ä½   å°æ•°
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 10  

             -æ˜¾ç¤ºä¸‰ä½
  548          //  @note                       ç‰¹åˆ«æ³¨æ„å½“å‘ç°å°æ•°éƒ¨åˆ†æ˜¾ç¤ºçš„å€¼ä¸ä½ å†™å…¥çš„å€¼ä¸ä¸€æ ·ç
             -š„æ—¶å€™ï¼Œ
  549          //                              å¯èƒ½æ˜¯ç”±äºæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±é—®é¢˜å¯¼è‡´çš„ï¼Œè¿™å¹¶ä¸æ˜¯æ˜¾ç¤ºå
             -‡½æ•°çš„é—®é¢˜ï¼Œ
  550          //                              æœ‰å…³é—®é¢˜çš„è¯¦æƒ…ï¼Œè¯·è‡ªè¡Œç™¾åº¦å­¦ä¹    æµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±é—®é
             -¢˜ã€‚
  551          //                              è´Ÿæ•°ä¼šæ˜¾ç¤ºä¸€ä¸ª â€˜-â€™å·   æ­£æ•°æ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼
  552          //-------------------------------------------------------------------------------------------------------
             -------------
  553          void ips114_showfloat_simspi(uint16 x, uint16 y, double dat, uint8 num, uint8 pointnum)
  554          {
  555   1        uint8 length;
  556   1        int8 buff[34];
  557   1        int8 start, end, point;
  558   1      
  559   1        if (6 < pointnum)
  560   1          pointnum = 6;
  561   1        if (10 < num)
  562   1          num = 10;
  563   1      
  564   1        if (0 > dat)
  565   1          length = zf_sprintf(&buff[0], "%f", dat); //è´Ÿæ•°
  566   1        else
  567   1        {
  568   2          length = zf_sprintf(&buff[1], "%f", dat);
  569   2          length++;
  570   2        }
  571   1        point = length - 7;     //è®¡ç®—å°æ•°ç‚¹ä½ç½®
  572   1        start = point - num - 1;  //è®¡ç®—èµ·å§‹ä½
  573   1        end = point + pointnum + 1; //è®¡ç®—ç»“æŸä½
  574   1        while (0 > start)     //æ•´æ•°ä½ä¸å¤Ÿ  æœ«å°¾åº”è¯¥å¡«å……ç©ºæ ¼
  575   1        {
  576   2          buff[end] = ' ';
  577   2          end++;
  578   2          start++;
  579   2        }
  580   1      
  581   1        if (0 > dat)
  582   1          buff[start] = '-';
  583   1        else
  584   1          buff[start] = ' ';
  585   1      
  586   1        buff[end] = '\0';
  587   1      
  588   1        ips114_showstr_simspi(x, y, buff); //æ˜¾ç¤ºæ•°å­—
  589   1      }
  590          
  591          //-------------------------------------------------------------------------------------------------------
             -------------
  592          //  ä»¥ä¸‹å‡½æ•°æ˜¯ä½¿ç”¨ç¡¬ä»¶SPIé€šä¿¡ï¼Œç›¸æ¯”è¾ƒè½¯ä»¶IICï¼Œé€Ÿåº¦æ¯”è½¯ä»¶IICå¿«ã€‚
  593          //-------------------------------------------------------------------------------------------------------
             -------------
  594          
  595          //-------------------------------------------------------------------------------------------------------
             -------------
  596          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
  597          //  @param      void
  598          //  @return
  599          //  @since      v1.0
  600          //  Sample usage:
  601          //-------------------------------------------------------------------------------------------------------
             -------------
  602          void ips114_writeIndex(uint8 dat) //å†™å‘½ä»¤
  603          {
  604   1        IPS114_CS(0);
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 11  

  605   1        IPS114_DC(0);
  606   1      
  607   1        spi_mosi(dat);
  608   1        IPS114_CS(1);
  609   1      }
  610          
  611          //-------------------------------------------------------------------------------------------------------
             -------------
  612          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
  613          //  @param      void
  614          //  @return
  615          //  @since      v1.0
  616          //  Sample usage:
  617          //-------------------------------------------------------------------------------------------------------
             -------------
  618          void ips114_writeData(uint8 dat) //å†™æ•°æ®
  619          {
  620   1        IPS114_CS(0);
  621   1        IPS114_DC(1);
  622   1      
  623   1        spi_mosi(dat);
  624   1        IPS114_CS(1);
  625   1      }
  626          
  627          //-------------------------------------------------------------------------------------------------------
             -------------
  628          //  @brief      å†…éƒ¨è°ƒç”¨ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ
  629          //  @param      void
  630          //  @return
  631          //  @since      v1.0
  632          //  Sample usage:
  633          //-------------------------------------------------------------------------------------------------------
             -------------
  634          void ips114_writedata_16bit(uint16 dat) //å‘æ¶²æ™¶å±å†™ä¸€ä¸ª16ä½æ•°æ®
  635          {
  636   1        uint8 dat1[2];
  637   1        dat1[0] = dat >> 8;
  638   1        dat1[1] = (uint8)dat;
  639   1        IPS114_CS(0);
  640   1        IPS114_DC(1);
  641   1        spi_mosi(dat1[0]); //å†™å…¥æ•°æ®  é«˜ä½åœ¨å‰  ä½ä½åœ¨å
  642   1        spi_mosi(dat1[1]);
  643   1        IPS114_CS(1);
  644   1      }
  645          
  646          //-------------------------------------------------------------------------------------------------------
             -------------
  647          //  @brief      1.14å¯¸ IPSæ¶²æ™¶åˆå§‹åŒ–
  648          //  @return     void
  649          //  @since      v1.0
  650          //  Sample usage:
  651          //-------------------------------------------------------------------------------------------------------
             -------------
  652          void ips114_init(void)
  653          {
  654   1        spi_init(IPS114_SPIN_PIN, IPS114_SCL_PIN, IPS114_SDA_PIN, IPS114_SDA_IN_PIN, 0, MASTER, SPI_SYSclk_DIV_4
             -);
  655   1      
  656   1        IPS114_BL(1);
  657   1        IPS114_DC(0);
  658   1        IPS114_REST(0);
  659   1      
  660   1        delay_ms(200);
  661   1      
  662   1        IPS114_REST(1);
  663   1        delay_ms(100);
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 12  

  664   1      
  665   1        ips114_writeIndex(0x36);
  666   1      
  667   1      #if (IPS114_DISPLAY_DIR == 0)
                 ips114_writeData(0x00);
               #elif (IPS114_DISPLAY_DIR == 1)
                 ips114_writeData(0xC0);
               #elif (IPS114_DISPLAY_DIR == 2)
                 ips114_writeData(0x70);
               #else
  674   1        ips114_writeData(0xA0);
  675   1      #endif
  676   1      
  677   1        ips114_writeIndex(0x3A);
  678   1        ips114_writeData(0x05);
  679   1      
  680   1        ips114_writeIndex(0xB2);
  681   1        ips114_writeData(0x0C);
  682   1        ips114_writeData(0x0C);
  683   1        ips114_writeData(0x00);
  684   1        ips114_writeData(0x33);
  685   1        ips114_writeData(0x33);
  686   1      
  687   1        ips114_writeIndex(0xB7);
  688   1        ips114_writeData(0x35);
  689   1      
  690   1        ips114_writeIndex(0xBB);
  691   1        ips114_writeData(0x37);
  692   1      
  693   1        ips114_writeIndex(0xC0);
  694   1        ips114_writeData(0x2C);
  695   1      
  696   1        ips114_writeIndex(0xC2);
  697   1        ips114_writeData(0x01);
  698   1      
  699   1        ips114_writeIndex(0xC3);
  700   1        ips114_writeData(0x12);
  701   1      
  702   1        ips114_writeIndex(0xC4);
  703   1        ips114_writeData(0x20);
  704   1      
  705   1        ips114_writeIndex(0xC6);
  706   1        ips114_writeData(0x0F);
  707   1      
  708   1        ips114_writeIndex(0xD0);
  709   1        ips114_writeData(0xA4);
  710   1        ips114_writeData(0xA1);
  711   1      
  712   1        ips114_writeIndex(0xE0);
  713   1        ips114_writeData(0xD0);
  714   1        ips114_writeData(0x04);
  715   1        ips114_writeData(0x0D);
  716   1        ips114_writeData(0x11);
  717   1        ips114_writeData(0x13);
  718   1        ips114_writeData(0x2B);
  719   1        ips114_writeData(0x3F);
  720   1        ips114_writeData(0x54);
  721   1        ips114_writeData(0x4C);
  722   1        ips114_writeData(0x18);
  723   1        ips114_writeData(0x0D);
  724   1        ips114_writeData(0x0B);
  725   1        ips114_writeData(0x1F);
  726   1        ips114_writeData(0x23);
  727   1      
  728   1        ips114_writeIndex(0xE1);
  729   1        ips114_writeData(0xD0);
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 13  

  730   1        ips114_writeData(0x04);
  731   1        ips114_writeData(0x0C);
  732   1        ips114_writeData(0x11);
  733   1        ips114_writeData(0x13);
  734   1        ips114_writeData(0x2C);
  735   1        ips114_writeData(0x3F);
  736   1        ips114_writeData(0x44);
  737   1        ips114_writeData(0x51);
  738   1        ips114_writeData(0x2F);
  739   1        ips114_writeData(0x1F);
  740   1        ips114_writeData(0x1F);
  741   1        ips114_writeData(0x20);
  742   1        ips114_writeData(0x23);
  743   1      
  744   1        ips114_writeIndex(0x21);
  745   1      
  746   1        ips114_writeIndex(0x11);
  747   1        delay_ms(120);
  748   1      
  749   1        ips114_writeIndex(0x29);
  750   1        ips114_clear(IPS114_BGCOLOR);
  751   1      }
  752          
  753          void ips114_set_region(uint16 x1, uint16 y1, uint16 x2, uint16 y2)
  754          {
  755   1      #if (IPS114_DISPLAY_DIR == 0)
                 {
                   ips114_writeIndex(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writedata_16bit(x1 + 52);
                   ips114_writedata_16bit(x2 + 52);
                   ips114_writeIndex(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writedata_16bit(y1 + 40);
                   ips114_writedata_16bit(y2 + 40);
                   ips114_writeIndex(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #elif (IPS114_DISPLAY_DIR == 1)
                 {
                   ips114_writeIndex(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writedata_16bit(x1 + 53);
                   ips114_writedata_16bit(x2 + 53);
                   ips114_writeIndex(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writedata_16bit(y1 + 40);
                   ips114_writedata_16bit(y2 + 40);
                   ips114_writeIndex(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #elif (IPS114_DISPLAY_DIR == 2)
                 {
                   ips114_writeIndex(0x2a); //åˆ—åœ°å€è®¾ç½®
                   ips114_writedata_16bit(x1 + 40);
                   ips114_writedata_16bit(x2 + 40);
                   ips114_writeIndex(0x2b); //è¡Œåœ°å€è®¾ç½®
                   ips114_writedata_16bit(y1 + 53);
                   ips114_writedata_16bit(y2 + 53);
                   ips114_writeIndex(0x2c); //å‚¨å­˜å™¨å†™
                 }
               #else
  786   1        {
  787   2          ips114_writeIndex(0x2a); //åˆ—åœ°å€è®¾ç½®
  788   2          ips114_writedata_16bit(x1 + 40);
  789   2          ips114_writedata_16bit(x2 + 40);
  790   2          ips114_writeIndex(0x2b); //è¡Œåœ°å€è®¾ç½®
  791   2          ips114_writedata_16bit(y1 + 52);
  792   2          ips114_writedata_16bit(y2 + 52);
  793   2          ips114_writeIndex(0x2c); //å‚¨å­˜å™¨å†™
  794   2        }
  795   1      #endif
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 14  

  796   1      }
  797          
  798          //-------------------------------------------------------------------------------------------------------
             -------------
  799          //  @brief      æ¶²æ™¶æ¸…å±å‡½æ•°
  800          //  @param      color         é¢œè‰²è®¾ç½®
  801          //  @return     void
  802          //  @since      v1.0
  803          //  Sample usage:               ips114_clear(YELLOW);// å…¨å±è®¾ç½®ä¸ºé»„è‰²
  804          //-------------------------------------------------------------------------------------------------------
             -------------
  805          void ips114_clear(uint16 color)
  806          {
  807   1        uint16 i, j;
  808   1        ips114_set_region(0, 0, IPS114_X_MAX - 1, IPS114_Y_MAX - 1);
  809   1        for (i = 0; i < IPS114_X_MAX; i++)
  810   1        {
  811   2          for (j = 0; j < IPS114_Y_MAX; j++)
  812   2          {
  813   3            ips114_writedata_16bit(color);
  814   3          }
  815   2        }
  816   1      }
  817          
  818          //-------------------------------------------------------------------------------------------------------
             -------------
  819          //  @brief      æ¶²æ™¶ç”»ç‚¹
  820          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹
  821          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹
  822          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„é¢œè‰²
  823          //  @return     void
  824          //  @since      v1.0
  825          //  Sample usage:               ips114_drawpoint(0,0,RED);  //åæ ‡0,0ç”»ä¸€ä¸ªçº¢è‰²çš„ç‚¹
  826          //-------------------------------------------------------------------------------------------------------
             -------------
  827          void ips114_drawpoint(uint16 x, uint16 y, uint16 color)
  828          {
  829   1        ips114_set_region(x, y, x, y);
  830   1        ips114_writedata_16bit(color);
  831   1      }
  832          
  833          //-------------------------------------------------------------------------------------------------------
             -------------
  834          //  @brief      æ¶²æ™¶æ˜¾ç¤ºå­—ç¬¦
  835          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  836          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  837          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦
  838          //  @return     void
  839          //  @since      v1.0
  840          //  Sample usage:               ips114_showchar(0,0,'x');//åæ ‡0,0å†™ä¸€ä¸ªå­—ç¬¦x
  841          //-------------------------------------------------------------------------------------------------------
             -------------
  842          void ips114_showchar(uint16 x, uint16 y, const int8 dat)
  843          {
  844   1        uint8 i, j;
  845   1        uint8 temp;
  846   1      
  847   1        for (i = 0; i < 16; i++)
  848   1        {
  849   2          ips114_set_region(x, y + i, x + 7, y + i);
  850   2          temp = tft_ascii[dat - 32][i]; //å‡32å› ä¸ºæ˜¯å–æ¨¡æ˜¯ä»ç©ºæ ¼å¼€å§‹å–å¾— ç©ºæ ¼åœ¨asciiä¸­åºå·æ˜
             -¯32
  851   2          for (j = 0; j < 8; j++)
  852   2          {
  853   3            if (temp & 0x01)
  854   3            {
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 15  

  855   4              ips114_writedata_16bit(IPS114_PENCOLOR);
  856   4            }
  857   3            else
  858   3              ips114_writedata_16bit(IPS114_BGCOLOR);
  859   3            temp >>= 1;
  860   3          }
  861   2        }
  862   1      }
  863          
  864          //-------------------------------------------------------------------------------------------------------
             -------------
  865          //  @brief      æ¶²æ™¶æ˜¾ç¤ºå­—ç¬¦ä¸²
  866          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  867          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  868          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å­—ç¬¦ä¸²
  869          //  @return     void
  870          //  @since      v1.0
  871          //  Sample usage:               ips114_showstr(0,0,"seekfree");
  872          //-------------------------------------------------------------------------------------------------------
             -------------
  873          void ips114_showstr(uint16 x, uint16 y, const int8 dat[])
  874          {
  875   1        uint16 j;
  876   1      
  877   1        j = 0;
  878   1        while (dat[j] != '\0')
  879   1        {
  880   2          ips114_showchar(x + 8 * j, y * 16, dat[j]);
  881   2          j++;
  882   2        }
  883   1      }
  884          
  885          //-------------------------------------------------------------------------------------------------------
             -------------
  886          //  @brief      æ¶²æ™¶æ˜¾ç¤º8ä½æœ‰ç¬¦å·
  887          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  888          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹  å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  889          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹int8
  890          //  @return     void
  891          //  @since      v1.0
  892          //  Sample usage:               ips114_showint8(0,0,x);//xä¸ºint8ç±»å‹
  893          //-------------------------------------------------------------------------------------------------------
             -------------
  894          void ips114_showint8(uint16 x, uint16 y, int8 dat)
  895          {
  896   1        uint8 a[3];
  897   1        uint8 i;
  898   1        if (dat < 0)
  899   1        {
  900   2          ips114_showchar(x, y * 16, '-');
  901   2          dat = -dat;
  902   2        }
  903   1        else
  904   1          ips114_showchar(x, y * 16, ' ');
  905   1      
  906   1        a[0] = dat / 100;
  907   1        a[1] = dat / 10 % 10;
  908   1        a[2] = dat % 10;
  909   1        i = 0;
  910   1        while (i < 3)
  911   1        {
  912   2          ips114_showchar((uint16)(x + (8 * (i + 1))), (uint16)(y * 16), (int8)('0' + a[i]));
  913   2          i++;
  914   2        }
  915   1      }
  916          
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 16  

  917          //-------------------------------------------------------------------------------------------------------
             -------------
  918          //  @brief      æ¶²æ™¶æ˜¾ç¤º8ä½æ— ç¬¦å·
  919          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  920          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  921          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint8
  922          //  @return     void
  923          //  @since      v1.0
  924          //  Sample usage:               ips114_showuint8(0,0,x);//xä¸ºuint8ç±»å‹
  925          //-------------------------------------------------------------------------------------------------------
             -------------
  926          void ips114_showuint8(uint16 x, uint16 y, uint8 dat)
  927          {
  928   1        uint8 a[3];
  929   1        uint8 i;
  930   1      
  931   1        a[0] = dat / 100;
  932   1        a[1] = dat / 10 % 10;
  933   1        a[2] = dat % 10;
  934   1        i = 0;
  935   1        while (i < 3)
  936   1        {
  937   2          ips114_showchar((uint16)(x + (8 * (i + 1))), (uint16)(y * 16), (int8)('0' + a[i]));
  938   2          i++;
  939   2        }
  940   1      }
  941          
  942          //-------------------------------------------------------------------------------------------------------
             -------------
  943          //  @brief      æ¶²æ™¶æ˜¾ç¤º16ä½æœ‰ç¬¦å·
  944          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  945          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  946          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹int16
  947          //  @return     void
  948          //  @since      v1.0
  949          //  Sample usage:               ips114_showint16(0,0,x);//xä¸ºint16ç±»å‹
  950          //-------------------------------------------------------------------------------------------------------
             -------------
  951          void ips114_showint16(uint16 x, uint16 y, int16 dat)
  952          {
  953   1        uint8 a[5];
  954   1        uint8 i;
  955   1        if (dat < 0)
  956   1        {
  957   2          ips114_showchar(x, y * 16, '-');
  958   2          dat = -dat;
  959   2        }
  960   1        else
  961   1          ips114_showchar(x, y * 16, ' ');
  962   1      
  963   1        a[0] = dat / 10000;
  964   1        a[1] = dat / 1000 % 10;
  965   1        a[2] = dat / 100 % 10;
  966   1        a[3] = dat / 10 % 10;
  967   1        a[4] = dat % 10;
  968   1      
  969   1        i = 0;
  970   1        while (i < 5)
  971   1        {
  972   2          ips114_showchar((uint16)(x + (8 * (i + 1))), (uint16)(y * 16), (int8)('0' + a[i]));
  973   2          i++;
  974   2        }
  975   1      }
  976          
  977          //-------------------------------------------------------------------------------------------------------
             -------------
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 17  

  978          //  @brief      æ¶²æ™¶æ˜¾ç¤º16ä½æ— ç¬¦å·
  979          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
  980          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
  981          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint16
  982          //  @return     void
  983          //  @since      v1.0
  984          //  Sample usage:               ips114_showuint16(0,0,x);//xä¸ºuint16ç±»å‹
  985          //-------------------------------------------------------------------------------------------------------
             -------------
  986          void ips114_showuint16(uint16 x, uint16 y, uint16 dat)
  987          {
  988   1        uint8 a[5];
  989   1        uint8 i;
  990   1      
  991   1        a[0] = dat / 10000;
  992   1        a[1] = dat / 1000 % 10;
  993   1        a[2] = dat / 100 % 10;
  994   1        a[3] = dat / 10 % 10;
  995   1        a[4] = dat % 10;
  996   1      
  997   1        i = 0;
  998   1        while (i < 5)
  999   1        {
 1000   2          ips114_showchar((uint8)(x + (8 * (i + 1))), (uint8)(y * 16), (int8)('0' + a[i]));
 1001   2          i++;
 1002   2        }
 1003   1      }
 1004          
 1005          //-------------------------------------------------------------------------------------------------------
             -------------
 1006          //  @brief      æ¶²æ™¶æ˜¾ç¤º32ä½æœ‰ç¬¦å·(å»é™¤æ•´æ•°éƒ¨åˆ†æ— æ•ˆçš„0)
 1007          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
 1008          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
 1009          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹uint32
 1010          //  @param      num             éœ€è¦æ˜¾ç¤ºçš„ä½æ•° æœ€é«˜10ä½  ä¸åŒ…å«æ­£è´Ÿå·
 1011          //  @return     void
 1012          //  @since      v1.0
 1013          //  Sample usage:               ips114_showuint32(0,0,x,3);//xå¯ä»¥ä¸ºint32 uint16 int16 uint8 int8ç±»å
             -‹
 1014          //  Sample usage:               è´Ÿæ•°ä¼šæ˜¾ç¤ºä¸€ä¸ª â€˜-â€™å·   æ­£æ•°æ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼
 1015          //-------------------------------------------------------------------------------------------------------
             -------------
 1016          void ips114_showint32(uint16 x, uint16 y, int32 dat, uint8 num)
 1017          {
 1018   1        int8 buff[34];
 1019   1        uint8 length;
 1020   1      
 1021   1        if (10 < num)
 1022   1          num = 10;
 1023   1      
 1024   1        num++;
 1025   1        if (0 > dat)
 1026   1          length = zf_sprintf(&buff[0], "%d", dat); //è´Ÿæ•°
 1027   1        else
 1028   1        {
 1029   2          buff[0] = ' ';
 1030   2          length = zf_sprintf(&buff[1], "%d", dat);
 1031   2          length++;
 1032   2        }
 1033   1        while (length < num)
 1034   1        {
 1035   2          buff[length] = ' ';
 1036   2          length++;
 1037   2        }
 1038   1        buff[num] = '\0';
 1039   1      
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 18  

 1040   1        ips114_showstr(x, y, buff); //æ˜¾ç¤ºæ•°å­—
 1041   1      }
 1042          
 1043          //-------------------------------------------------------------------------------------------------------
             -------------
 1044          //  @brief      æ¶²æ™¶æ˜¾ç¤ºæµ®ç‚¹æ•°(å»é™¤æ•´æ•°éƒ¨åˆ†æ— æ•ˆçš„0)
 1045          //  @param      x               åæ ‡xæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_X_MAX-1ï¼‰
 1046          //  @param      y               åæ ‡yæ–¹å‘çš„èµ·ç‚¹ å‚æ•°èŒƒå›´ 0 -ï¼ˆIPS114_Y_MAX/16-1ï¼‰
 1047          //  @param      dat             éœ€è¦æ˜¾ç¤ºçš„å˜é‡ï¼Œæ•°æ®ç±»å‹floatæˆ–double
 1048          //  @param      num             æ•´æ•°ä½æ˜¾ç¤ºé•¿åº¦   æœ€é«˜10ä½
 1049          //  @param      pointnum        å°æ•°ä½æ˜¾ç¤ºé•¿åº¦   æœ€é«˜6ä½
 1050          //  @return     void
 1051          //  @since      v1.0
 1052          //  Sample usage:               ips114_showfloat(0,0,x,2,3);//æ˜¾ç¤ºæµ®ç‚¹æ•°   æ•´æ•°æ˜¾ç¤º2ä½   å°æ•°
             -æ˜¾ç¤ºä¸‰ä½
 1053          //  @note                       ç‰¹åˆ«æ³¨æ„å½“å‘ç°å°æ•°éƒ¨åˆ†æ˜¾ç¤ºçš„å€¼ä¸ä½ å†™å…¥çš„å€¼ä¸ä¸€æ ·ç
             -š„æ—¶å€™ï¼Œ
 1054          //                              å¯èƒ½æ˜¯ç”±äºæµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±é—®é¢˜å¯¼è‡´çš„ï¼Œè¿™å¹¶ä¸æ˜¯æ˜¾ç¤ºå
             -‡½æ•°çš„é—®é¢˜ï¼Œ
 1055          //                              æœ‰å…³é—®é¢˜çš„è¯¦æƒ…ï¼Œè¯·è‡ªè¡Œç™¾åº¦å­¦ä¹    æµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±é—®é
             -¢˜ã€‚
 1056          //                              è´Ÿæ•°ä¼šæ˜¾ç¤ºä¸€ä¸ª â€˜-â€™å·   æ­£æ•°æ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼
 1057          //-------------------------------------------------------------------------------------------------------
             -------------
 1058          void ips114_showfloat(uint16 x, uint16 y, double dat, uint8 num, uint8 pointnum)
 1059          {
 1060   1        uint8 length;
 1061   1        int8 buff[34];
 1062   1        int8 start, end, point;
 1063   1      
 1064   1        if (6 < pointnum)
 1065   1          pointnum = 6;
 1066   1        if (10 < num)
 1067   1          num = 10;
 1068   1      
 1069   1        if (0 > dat)
 1070   1          length = zf_sprintf(&buff[0], "%f", dat); //è´Ÿæ•°
 1071   1        else
 1072   1        {
 1073   2          length = zf_sprintf(&buff[1], "%f", dat);
 1074   2          length++;
 1075   2        }
 1076   1        point = length - 7;     //è®¡ç®—å°æ•°ç‚¹ä½ç½®
 1077   1        start = point - num - 1;  //è®¡ç®—èµ·å§‹ä½
 1078   1        end = point + pointnum + 1; //è®¡ç®—ç»“æŸä½
 1079   1        while (0 > start)     //æ•´æ•°ä½ä¸å¤Ÿ  æœ«å°¾åº”è¯¥å¡«å……ç©ºæ ¼
 1080   1        {
 1081   2          buff[end] = ' ';
 1082   2          end++;
 1083   2          start++;
 1084   2        }
 1085   1      
 1086   1        if (0 > dat)
 1087   1          buff[start] = '-';
 1088   1        else
 1089   1          buff[start] = ' ';
 1090   1      
 1091   1        buff[end] = '\0';
 1092   1      
 1093   1        ips114_showstr(x, y, buff); //æ˜¾ç¤ºæ•°å­—
 1094   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      3695     ------
  ecode size           =    ------     ------
C251 COMPILER V5.60.0,  SEEKFREE_IPS114_SPI                                                14/06/24  16:35:49  PAGE 19  

  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------        246
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         6     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
